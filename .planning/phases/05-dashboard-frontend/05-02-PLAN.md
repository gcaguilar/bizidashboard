---
phase: 05-dashboard-frontend
plan: 02
type: execute
wave: 2
depends_on: ["01"]
files_modified: [src/app/dashboard/page.tsx, src/app/dashboard/_components/DashboardClient.tsx, src/app/dashboard/_components/MapPanel.tsx, src/app/dashboard/_components/StatusBanner.tsx, src/app/dashboard/_components/AlertsPanel.tsx, src/app/dashboard/_components/RankingsTable.tsx, src/app/dashboard/_components/StationPicker.tsx, src/app/dashboard/_components/HourlyCharts.tsx, src/app/dashboard/_components/Heatmap.tsx]
autonomous: true

must_haves:
  truths:
    - "La ruta `/dashboard` se renderiza en servidor con datos iniciales"
    - "Los paneles base muestran textos en espanol y datos resumidos"
    - "Existe un selector de estacion visible y conectado al estado"
    - "El layout responde en movil y desktop sin estados de carga"
  artifacts:
    - path: "src/app/dashboard/page.tsx"
      provides: "Server Component que carga datos iniciales"
      exports: ["default"]
    - path: "src/app/dashboard/_components/DashboardClient.tsx"
      provides: "Shell cliente con estado de estacion y layout"
      exports: ["DashboardClient"]
    - path: "src/app/dashboard/_components/MapPanel.tsx"
      provides: "Mapa de estaciones con marcadores"
      exports: ["MapPanel"]
    - path: "src/app/dashboard/_components/RankingsTable.tsx"
      provides: "Tabla de rankings con busqueda y orden"
      exports: ["RankingsTable"]
    - path: "src/app/dashboard/_components/StationPicker.tsx"
      provides: "Selector visible de estacion"
      exports: ["StationPicker"]
    - path: "src/app/dashboard/_components/HourlyCharts.tsx"
      provides: "Graficas de patrones por hora"
      exports: ["HourlyCharts"]
    - path: "src/app/dashboard/_components/Heatmap.tsx"
      provides: "Heatmap de ocupacion por hora y dia"
      exports: ["Heatmap"]
    - path: "src/app/dashboard/_components/AlertsPanel.tsx"
      provides: "Panel de alertas activas"
      exports: ["AlertsPanel"]
    - path: "src/app/dashboard/_components/StatusBanner.tsx"
      provides: "Indicador de ultima actualizacion"
      exports: ["StatusBanner"]
  key_links:
    - from: "src/app/dashboard/page.tsx"
      to: "/api/stations"
      via: "fetchStations"
      pattern: "fetchStations"
    - from: "src/app/dashboard/page.tsx"
      to: "/api/rankings"
      via: "fetchRankings"
      pattern: "fetchRankings"
    - from: "src/app/dashboard/page.tsx"
      to: "/api/patterns"
      via: "fetchPatterns"
      pattern: "fetchPatterns"
    - from: "src/app/dashboard/page.tsx"
      to: "/api/heatmap"
      via: "fetchHeatmap"
      pattern: "fetchHeatmap"
    - from: "src/app/dashboard/page.tsx"
      to: "/api/alerts"
      via: "fetchAlerts"
      pattern: "fetchAlerts"
    - from: "src/app/dashboard/page.tsx"
      to: "/api/status"
      via: "fetchStatus"
      pattern: "fetchStatus"
---

<objective>
Montar la ruta /dashboard con shell cliente y paneles stub en espanol.

Purpose: Garantizar render inicial en servidor con datos y estructura base de paneles.
Output: Ruta /dashboard con datos iniciales y componentes conectados.
</objective>

<execution_context>
@/home/guichu/.config/opencode/get-shit-done/workflows/execute-plan.md
@/home/guichu/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-dashboard-frontend/05-RESEARCH.md
@src/app/api/stations/route.ts
@src/app/api/rankings/route.ts
@src/app/api/patterns/route.ts
@src/app/api/heatmap/route.ts
@src/app/api/alerts/route.ts
@src/app/api/status/route.ts
@src/lib/api.ts
@src/app/dashboard/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Montar la ruta /dashboard con shell cliente y paneles stub</name>
  <files>src/app/dashboard/page.tsx, src/app/dashboard/_components/DashboardClient.tsx, src/app/dashboard/_components/MapPanel.tsx, src/app/dashboard/_components/StatusBanner.tsx, src/app/dashboard/_components/AlertsPanel.tsx, src/app/dashboard/_components/RankingsTable.tsx, src/app/dashboard/_components/StationPicker.tsx, src/app/dashboard/_components/HourlyCharts.tsx, src/app/dashboard/_components/Heatmap.tsx</files>
  <action>
Crea `src/app/dashboard/page.tsx` como Server Component que carga en paralelo `stations`, `status`, `alerts`, `rankings` (turnover y availability) y datos iniciales de `patterns`/`heatmap` para la estacion por defecto (primer elemento de `stations`). Usa los helpers de `src/lib/api.ts` y evita cualquier loading state en el render inicial. Pasa todo a `DashboardClient` como `initialData`. Implementa `DashboardClient` como Client Component que mantiene `selectedStationId` y expone props a paneles; define un layout responsive (grid en desktop, stack en movil) con encabezados en espanol. Crea paneles stub (MapPanel, StatusBanner, AlertsPanel, RankingsTable, StationPicker, HourlyCharts, Heatmap) con estructura basica y props tipadas, mostrando un resumen simple de datos para confirmar wiring, sin logica avanzada aun.
  </action>
  <verify>npm run lint</verify>
  <done>La ruta `/dashboard` renderiza en servidor con datos iniciales y un layout en espanol con paneles conectados.</done>
</task>

</tasks>

<verification>
- `npm run lint`
</verification>

<success_criteria>
- `/dashboard` carga datos iniciales en servidor y muestra los paneles base sin estados de carga.
- Paneles stub renderizan datos y textos en espanol.
</success_criteria>

<output>
After completion, create `.planning/phases/05-dashboard-frontend/05-02-SUMMARY.md`
</output>
